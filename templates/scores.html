<!DOCTYPE html>
<html lang="en">
<head>
  <title>FantasyPoints</title>
  <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
		integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
		crossorigin="anonymous">
  </script>
  <script src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.18/css/jquery.dataTables.min.css" />
</head>
<body>
<table id="scores">
  <thead>
    <tr>
      <th></th>
      <th>Player</th>
      <th>Team</th>
      <th>Position</th>
      <th>Total Points</th>
      <th>Points Per Play</th>
      <th>Number of Plays</th>
      <th>Touchdowns</th>
      <th>Yards</th>
      <th>Attempts</th>
      <th>Yards Per Attempt</th>
      <th>Passing Yards</th>
      <th>Passing Attempts</th>
      <th>Passing Yards Per Attempt</th>
      <th>Recieving Yards</th>
      <th>Recieving Targets</th>
      <th>Passing Yards Per Target</th>
      <th>Rushing Yards</th>
      <th>Rushing Attempts</th>
      <th>Rushing Yards Per Attempt</th>
      <th>Games Played</th>
    </tr>
  </thead>
  <tbody>
    {% for player, row in data %}
      <tr>
        <td></td>
        <td data-order="{{ player.last_name }}, {{ player.first_name }}">
          {{ player.full_name }}
        </td>
        <td>{{ player.team }}</td>
        <td>{{ player.position }}</td>
        <td>{{ row.total_points }}</td>
        <td>{{ row.points_per_play }}</td>
        <td>{{ row.number_of_plays }}</td>
        <td>{{ row.touchdowns }}</td>
        <td>{{ row.yards }}</td>
        <td>{{ row.attempts }}</td>
        <td>{{ row.yards_per_attempt }}</td>
        <td>{{ row.passing_yards }}</td>
        <td>{{ row.passing_attempts }}</td>
        <td>{{ row.passing_yards_per_attempt }}</td>
        <td>{{ row.receiving_yards }}</td>
        <td>{{ row.receiving_attempts }}</td>
        <td>{{ row.receiving_yards_per_attempt }}</td>
        <td>{{ row.rushing_yards }}</td>
        <td>{{ row.rushing_attempts }}</td>
        <td>{{ row.rushing_yards_per_attempt }}</td>
        <td>{{ row.games_played }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
<script>
  $(document).ready( function () {

    // Create table
    var t = $('#scores').DataTable({
      'paging': false,
      'order': [[ 1, 'asc' ]]
    });

    // Add row numbers
    // Modified from https://datatables.net/examples/api/counter_columns.html
    t.on( 'order.dt search.dt', function () {
      t.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
        cell.innerHTML = i+1;
      });
    }).draw();

    // Color cells
    t.columns().every( function () {
      var max = this.data().reduce( function (a, b) {
        return Math.max(a, b);
      });
      this.nodes().forEach( function (item, index, array) {
        item.css({'background-color': `hsv(12.8, ${parseFloat(item.html()) / max}, 235)`});
      });
    });
  });
</script>
</body>
</html>
